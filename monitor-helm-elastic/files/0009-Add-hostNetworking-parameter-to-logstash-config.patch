From e74f1d703b1f2c7b71038a95be90bebbef9613da Mon Sep 17 00:00:00 2001
From: Simon Cousineau <Simon.Cousineau@windriver.com>
Date: Thu, 16 Apr 2020 09:29:41 -0400
Subject: [PATCH 1/1] Add hostNetworking parameter to logstash config

---
 logstash/templates/statefulset.yaml | 4 ++++
 logstash/values.yaml                | 2 ++
 2 files changed, 6 insertions(+)

diff --git a/logstash/templates/statefulset.yaml b/logstash/templates/statefulset.yaml
index e162023..1355e7b 100644
--- a/logstash/templates/statefulset.yaml
+++ b/logstash/templates/statefulset.yaml
@@ -110,6 +110,10 @@ spec:
 {{ toYaml . | indent 10 }}
       {{- end }}
       terminationGracePeriodSeconds: {{ .Values.terminationGracePeriod }}
+      {{- if .Values.hostNetworking }}
+      hostNetwork: true
+      dnsPolicy: ClusterFirstWithHostNet
+      {{- end }}
       volumes:
         {{- range .Values.secretMounts }}
         - name: {{ .name }}
diff --git a/logstash/values.yaml b/logstash/values.yaml
index 9fedf40..6c6ef5d 100755
--- a/logstash/values.yaml
+++ b/logstash/values.yaml
@@ -212,3 +212,5 @@ command: []
 
 # pass custom args. This is equivalent of Cmd in docker
 args: []
+
+hostNetworking: true
-- 
2.20.1

